!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(n="undefined"!=typeof globalThis?globalThis:n||self).MyVacancies=e()}(this,(function(){"use strict";const n=n=>n>=5?"дней":n>=2?"дня":"день",e=e=>{const a=(n=>{if(!n)return"";const{from:e,to:a,currency:t}=n,o=n=>n?n.toLocaleString("ru-RU"):"",i={RUR:"₽",USD:"$",EUR:"€"}[t]||t;return e&&a?`${o(e)} – ${o(a)} ${i}`:e?`от ${o(e)} ${i}`:a?`до ${o(a)} ${i}`:""})(e.salary);return`\n        <div class="job-card" data-job-id="${e.id}">\n            <div class="job-header">\n                <div>\n                    <h2 class="job-title">${e.title}</h2>\n                    ${a?`<div class="salary">${a}</div>`:""}\n                </div>\n                <div class="published-date">${(e=>{const a=new Date(e),t=new Date-a,o=Math.floor(t/864e5);return 0===o?"Сегодня":1===o?"Вчера":o<7?`${o} ${n(o)} назад`:a.toLocaleDateString("ru-RU",{day:"numeric",month:"long"})})(e.published_at)}</div>\n            </div>\n            <div class="company-info">\n                <span class="company-name">${e.company}</span>\n                ${e.verified?'<span class="verified-badge">✓</span>':""}\n            </div>\n            <div class="location">${e.location}</div>\n            <div class="tags-container">\n                ${e.tags.map((n=>`\n                    <span class="tag ${n.special?"no-resume-tag":""}">${n.text}</span>\n                `)).join("")}\n            </div>\n            <div class="buttons-container">\n                <button class="details-button">Подробнее</button>\n            </div>\n        </div>\n    `},a='\n    <style>\n        .plugin-container {\n            padding: 24px;\n            font-family: \'Inter\', system-ui, -apple-system, sans-serif;\n            color: #2C3E50;\n            max-width: 1200px;\n            margin: 0 auto;\n            display: grid;\n            grid-template-columns: 1fr 300px;\n            gap: 24px;\n        }\n\n        .main-content {\n            grid-column: 1;\n        }\n\n        .search-container {\n            background-color: #ffffff;\n            border-radius: 16px;\n            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);\n            padding: 24px;\n            margin-bottom: 32px;\n            border: 1px solid #f1f5f9;\n        }\n\n        .search-form {\n            display: flex;\n            gap: 16px;\n        }\n\n        .search-input {\n            flex: 1;\n            padding: 14px 20px;\n            border: 1px solid #e2e8f0;\n            border-radius: 12px;\n            font-size: 16px;\n            color: #1a202c;\n            transition: all 0.2s ease;\n            background-color: #f8fafc;\n            width: 100%;\n        }\n\n        .search-input:focus {\n            outline: none;\n            border-color: #2563eb;\n            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);\n            background-color: #ffffff;\n        }\n\n        .search-input::placeholder {\n            color: #94a3b8;\n        }\n\n        .search-button {\n            background-color: #2563eb;\n            color: white;\n            padding: 14px 28px;\n            border-radius: 12px;\n            border: none;\n            cursor: pointer;\n            font-weight: 500;\n            white-space: nowrap;\n            transition: all 0.2s ease;\n            font-size: 16px;\n        }\n\n        .search-button:hover {\n            background-color: #1d4ed8;\n            transform: translateY(-1px);\n        }\n\n        .search-button:active {\n            transform: translateY(0);\n        }\n\n        .search-stats {\n            margin-top: 16px;\n            color: #64748b;\n            font-size: 14px;\n        }\n\n        .load-more {\n            display: none;\n            margin: 32px auto;\n            padding: 14px 32px;\n            background-color: #f8fafc;\n            color: #2563eb;\n            border: 1px solid #e2e8f0;\n            border-radius: 12px;\n            cursor: pointer;\n            font-weight: 500;\n            transition: all 0.2s ease;\n            font-size: 16px;\n        }\n\n        .load-more:hover {\n            background-color: #f1f5f9;\n            transform: translateY(-1px);\n        }\n\n        .load-more:active {\n            transform: translateY(0);\n        }\n\n        .filters-container {\n            grid-column: 2;\n            background: #ffffff;\n            border-radius: 16px;\n            padding: 20px;\n            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);\n            border: 1px solid #f1f5f9;\n            align-self: flex-start;\n        }\n\n        .mobile-filters-button {\n            display: none;\n            width: 100%;\n            padding: 14px 32px;\n            background-color: #f8fafc;\n            color: #2563eb;\n            border: 1px solid #e2e8f0;\n            border-radius: 12px;\n            font-size: 16px;\n            font-weight: 500;\n            cursor: pointer;\n            margin-bottom: 16px;\n            transition: all 0.2s ease;\n        }\n\n        .mobile-filters-button:hover {\n            background-color: #f1f5f9;\n            transform: translateY(-1px);\n        }\n\n        .mobile-filters-button:active {\n            transform: translateY(0);\n        }\n\n        @media (max-width: 768px) {\n            .plugin-container {\n                grid-template-columns: 1fr;\n                padding: 16px;\n            }\n\n            .filters-container {\n                grid-column: 1;\n                display: none;\n                position: fixed;\n                top: 0;\n                left: 0;\n                right: 0;\n                bottom: 0;\n                z-index: 1000;\n                border-radius: 0;\n                overflow-y: auto;\n                background: #ffffff;\n                padding: 20px;\n                height: 100vh;\n                -webkit-overflow-scrolling: touch;\n            }\n\n            .filter-group:last-child {\n                margin-bottom: 60px;\n            }\n\n            .filters-container::after {\n                content: \'\';\n                display: block;\n                height: 40px;\n            }\n\n            .filters-container.active {\n                display: block;\n            }\n\n            .mobile-filters-button {\n                display: block;\n            }\n        }\n\n        .filters-title {\n            margin: 0 0 16px 0;\n            font-size: 18px;\n            color: #1a202c;\n        }\n\n        .filter-group {\n            margin-bottom: 24px;\n        }\n\n        .filter-group h4 {\n            margin: 0 0 12px 0;\n            font-size: 16px;\n            color: #4a5568;\n        }\n\n        .radio-group {\n            display: flex;\n            flex-direction: column;\n            gap: 10px;\n        }\n\n        .radio-label {\n            display: flex;\n            align-items: center;\n            gap: 8px;\n            cursor: pointer;\n            font-size: 14px;\n            color: #4a5568;\n        }\n\n        .radio-label input[type="radio"] {\n            appearance: none;\n            width: 16px;\n            height: 16px;\n            border: 2px solid #cbd5e0;\n            border-radius: 50%;\n            margin: 0;\n            position: relative;\n            cursor: pointer;\n        }\n\n        .radio-label input[type="radio"]:checked {\n            border-color: #2563eb;\n        }\n\n        .radio-label input[type="radio"]:checked::after {\n            content: \'\';\n            position: absolute;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%, -50%);\n            width: 8px;\n            height: 8px;\n            background: #2563eb;\n            border-radius: 50%;\n        }\n\n        .radio-label:hover input[type="radio"] {\n            border-color: #2563eb;\n        }\n\n        .loader {\n            display: none;\n            width: 48px;\n            height: 48px;\n            border: 4px solid #f3f3f3;\n            border-top: 4px solid #2563eb;\n            border-radius: 50%;\n            animation: spin 1s linear infinite;\n            margin: 32px auto;\n        }\n\n        @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n        }\n\n        \n    .job-card {\n        background-color: #ffffff;\n        border-radius: 16px;\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\n        padding: 24px;\n        margin-bottom: 16px;\n        border: 1px solid #f1f5f9;\n    }\n\n    .job-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: flex-start;\n        margin-bottom: 16px;\n    }\n\n    .published-date {\n        color: #94a3b8;\n        font-size: 14px;\n        white-space: nowrap;\n        flex-shrink: 0;\n        margin-left: 16px;\n    }\n\n    .job-title {\n        font-size: 20px;\n        font-weight: 600;\n        margin-bottom: 8px;\n        color: #1a202c;\n        font-family: \'Inter\', system-ui, -apple-system, sans-serif;\n    }\n\n    .salary {\n        font-size: 18px;\n        font-weight: 600;\n        color: #2563eb;\n        margin-bottom: 12px;\n    }\n\n    .company-info {\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        margin-bottom: 12px;\n    }\n\n    .company-name {\n        font-weight: 500;\n        color: #4a5568;\n    }\n\n    .verified-badge {\n        background: #10B981;\n        color: white;\n        width: 20px;\n        height: 20px;\n        border-radius: 50%;\n        display: inline-flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 12px;\n    }\n\n    .location {\n        color: #6b7280;\n        font-size: 14px;\n        display: flex;\n        align-items: center;\n        gap: 6px;\n    }\n\n    .location::before {\n        content: \'\';\n        width: 18px;\n        height: 18px;\n        background-image: url("data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 24 24\' fill=\'%236b7280\'%3E%3Cpath d=\'M12 0C7.802 0 4 3.403 4 7.602C4 11.8 12 24 12 24s8-12.2 8-16.398C20 3.403 16.199 0 12 0zm0 11c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3z\'/%3E%3C/svg%3E");\n        background-size: contain;\n        background-repeat: no-repeat;\n        background-position: center;\n    }\n\n    .tags-container {\n        display: flex;\n        gap: 8px;\n        flex-wrap: wrap;\n        margin: 16px 0;\n    }\n\n    .tag {\n        background-color: #f8fafc;\n        padding: 6px 12px;\n        border-radius: 8px;\n        font-size: 14px;\n        color: #64748b;\n        border: 1px solid #e2e8f0;\n    }\n\n    .no-resume-tag {\n        background-color: #f0fdf4;\n        color: #059669;\n        border-color: #bbf7d0;\n    }\n\n    .buttons-container {\n        display: flex;\n        gap: 12px;\n        margin-top: 16px;\n    }\n\n    .details-button {\n        background-color: #2563eb;\n        color: white;\n        padding: 12px 24px;\n        border-radius: 8px;\n        border: none;\n        cursor: pointer;\n        font-weight: 500;\n        font-size: 15px;\n    }\n\n    .details-button:hover {\n        background-color: #1d4ed8;\n    }\n\n    @media (max-width: 768px) {\n        .job-header {\n            flex-direction: column;\n        }\n\n        .published-date {\n            order: -1;\n            margin-left: 0;\n            margin-bottom: 8px;\n        }\n\n        .job-title {\n            word-break: break-word;\n        }\n\n        .details-button {\n            width: 100%;\n        }\n    }\n\n    </style>\n    <div class="plugin-container">\n        <div class="main-content">\n            <div class="search-container">\n                <form class="search-form">\n                    <input type="text" class="search-input" placeholder="Поиск вакансий...">\n                    <button type="submit" class="search-button">Найти</button>\n                </form>\n                <div class="search-stats">\n                    Найдено вакансий: <span class="vacancies-count">0</span>\n                </div>\n            </div>\n            <button class="mobile-filters-button">Фильтры</button>\n            <div class="loader"></div>\n            <div class="jobs-container">\n                \x3c!-- Сюда будут добавляться карточки вакансий --\x3e\n            </div>\n            <button class="load-more">Показать ещё</button>\n        </div>\n        \n    <style>\n      .close-filters {\n        display: none;\n      }\n      .close-filters:hover {\n        background: #e9ecef;\n        color: #2C3E50;\n      }\n      @media (max-width: 768px) {\n        .close-filters {\n          display: block;\n          background: #f8f9fa;\n          border: none;\n          font-size: 20px;\n          cursor: pointer;\n          padding: 0;\n          width: 36px;\n          height: 36px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          border-radius: 50%;\n          color: #6c757d;\n          transition: all 0.2s ease;\n        }\n      }\n    </style>\n    <div class="filters-container">\n      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">\n        <h3 class="filters-title">Фильтры</h3>\n        <button class="close-filters">×</button>\n      </div>\n      \n      <div class="filter-group">\n        <h4>Опыт работы</h4>\n        <div class="radio-group">\n          <label class="radio-label">\n            <input type="radio" name="experience" value="" checked>\n            <span>Все</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="experience" value="noExperience">\n            <span>Без опыта</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="experience" value="between1And3">\n            <span>1-3 года</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="experience" value="between3And6">\n            <span>3-6 лет</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="experience" value="moreThan6">\n            <span>Более 6 лет</span>\n          </label>\n        </div>\n      </div>\n      \n      <div class="filter-group">\n        <h4>Тип занятости</h4>\n        <div class="radio-group">\n          <label class="radio-label">\n            <input type="radio" name="employment" value="" checked>\n            <span>Все</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="employment" value="full">\n            <span>Полная занятость</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="employment" value="part">\n            <span>Частичная занятость</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="employment" value="project">\n            <span>Проектная работа</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="employment" value="volunteer">\n            <span>Волонтёрство</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="employment" value="probation">\n            <span>Стажировка</span>\n          </label>\n        </div>\n      </div>\n\n      <div class="filter-group">\n        <h4>График работы</h4>\n        <div class="radio-group">\n          <label class="radio-label">\n            <input type="radio" name="schedule" value="" checked>\n            <span>Все</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="schedule" value="fullDay">\n            <span>Полный день</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="schedule" value="shift">\n            <span>Сменный график</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="schedule" value="flexible">\n            <span>Гибкий график</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="schedule" value="remote">\n            <span>Удаленная работа</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="schedule" value="flyInFlyOut">\n            <span>Вахтовый метод</span>\n          </label>\n        </div>\n      </div>\n\n      <div class="filter-group">\n        <h4>Сортировка</h4>\n        <div class="radio-group">\n          <label class="radio-label">\n            <input type="radio" name="order_by" value="publication_time" checked>\n            <span>По дате публикации</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="order_by" value="salary_desc">\n            <span>По убыванию зарплаты</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="order_by" value="salary_asc">\n            <span>По возрастанию зарплаты</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="order_by" value="relevance">\n            <span>По релевантности</span>\n          </label>\n        </div>\n      </div>\n    </div>\n  \n    </div>\n',t="https://api.hh.ru",o={"User-Agent":"Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1",Accept:"application/json"};async function i(n={}){if(!n.employer_id)throw new Error("employer_id является обязательным параметром");const e=Object.entries(n).reduce(((n,[e,a])=>(Array.isArray(a)?n[e]=a.join(","):n[e]=a,n)),{}),a=new URLSearchParams({page:e.page||0,per_page:Math.min(e.per_page||20,100),...e});try{const n=await fetch(`${t}/vacancies?${a}`,{headers:o});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return await n.json()}catch(i){throw i}}const r="\n    .job-popup-overlay {\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background: rgba(0, 0, 0, 0.5);\n        display: flex;\n        justify-content: center;\n        align-items: flex-start;\n        z-index: 1000;\n\n        \n        -webkit-overflow-scrolling: touch;\n        overflow-y: auto;\n        height: 100%;\n        min-height: 100%;\n        padding: 20px;\n        box-sizing: border-box;\n    }\n\n    @supports (-webkit-touch-callout: none) {\n        .job-popup-overlay {\n            height: -webkit-fill-available;\n            min-height: -webkit-fill-available;\n        }\n    }\n\n    .job-popup {\n        background: white;\n        padding: 32px;\n        border-radius: 16px;\n        max-width: 800px;\n        width: 100%;\n        margin: auto;\n        position: relative;\n        color: #2C3E50;\n        font-family: 'Inter', system-ui, -apple-system, sans-serif;\n        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);\n    }\n\n    @media (max-width: 768px) {\n        .job-popup-overlay {\n            padding: 0;\n        }\n\n        .job-popup {\n            min-height: 100%;\n            border-radius: 0;\n            margin: 0;\n            padding: 24px 16px;\n            box-sizing: border-box;\n        }\n    }\n\n    .popup-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: flex-start;\n        gap: 16px;\n        margin-bottom: 16px;\n        padding-right: 40px;\n    }\n\n    .published-date {\n        color: #94a3b8;\n        font-size: 14px;\n        margin: 16px 0 24px;\n    }\n\n    .close-popup {\n        position: absolute;\n        right: 20px;\n        top: 20px;\n        background: #f8f9fa;\n        border: none;\n        font-size: 20px;\n        cursor: pointer;\n        padding: 0;\n        width: 36px;\n        height: 36px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        border-radius: 50%;\n        color: #6c757d;\n        transition: all 0.2s ease;\n    }\n\n    .close-popup:hover {\n        background: #e9ecef;\n        color: #2C3E50;\n    }\n\n    h2 {\n        font-size: 24px;\n        margin: 0 0 16px 0;\n        color: #1a202c;\n        padding-right: 40px;\n    }\n\n    .salary {\n        font-size: 20px;\n        font-weight: 600;\n        color: #2563eb;\n        margin-bottom: 12px;\n    }\n\n    .company-info {\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        margin-bottom: 8px;\n    }\n\n    .company-name {\n        font-size: 16px;\n        color: #4a5568;\n    }\n\n    .verified-badge {\n        background: #10B981;\n        color: white;\n        width: 20px;\n        height: 20px;\n        border-radius: 50%;\n        display: inline-flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 12px;\n    }\n\n    .location {\n        color: #6b7280;\n        font-size: 14px;\n        margin-bottom: 24px;\n        display: flex;\n        align-items: center;\n        gap: 6px;\n    }\n\n    .location::before {\n        content: '';\n        width: 18px;\n        height: 18px;\n        background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%236b7280'%3E%3Cpath d='M12 0C7.802 0 4 3.403 4 7.602C4 11.8 12 24 12 24s8-12.2 8-16.398C20 3.403 16.199 0 12 0zm0 11c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3z'/%3E%3C/svg%3E\");\n        background-size: contain;\n        background-repeat: no-repeat;\n        background-position: center;\n    }\n\n    .description {\n        margin: 24px 0;\n        line-height: 1.6;\n        color: #4a5568;\n    }\n    \n    .description img {\n        max-width: 100%;\n        height: auto;\n        border-radius: 8px;\n    }\n\n    .apply-button {\n        background: #2563eb;\n        color: white;\n        border: none;\n        padding: 14px 28px;\n        border-radius: 8px;\n        font-size: 16px;\n        font-weight: 500;\n        cursor: pointer;\n        transition: all 0.2s ease;\n        width: 100%;\n    }\n\n    .apply-button:hover {\n        background: #1d4ed8;\n        transform: translateY(-1px);\n    }\n\n    .apply-button:active {\n        transform: translateY(0);\n    }\n\n    .popup-loader {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        min-height: 200px;\n    }\n\n    .popup-loader::after {\n        content: \"\";\n        width: 40px;\n        height: 40px;\n        border: 4px solid #f3f3f3;\n        border-top: 4px solid #2563eb;\n        border-radius: 50%;\n        animation: spin 1s linear infinite;\n    }\n\n    @keyframes spin {\n        0% { transform: rotate(0deg); }\n        100% { transform: rotate(360deg); }\n    }\n";class s extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return["primary-color"]}attributeChangedCallback(n,e,a){"primary-color"===n&&e!==a&&(this.primaryColor=a||"#2563eb",this.vacancy&&this.updateContent())}connectedCallback(){document.body.style.overflow="hidden",this.isIOS()&&(document.body.style.position="fixed",document.body.style.width="100%"),this.shadowRoot.addEventListener("click",(n=>{(n.target.classList.contains("job-popup-overlay")||n.target.classList.contains("close-popup"))&&this.closePopup()}))}disconnectedCallback(){document.body.style.overflow="",this.isIOS()&&(document.body.style.position="",document.body.style.width="")}closePopup(){this.remove()}isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}setContent(n){this.vacancy=n,this.updateContent()}updateContent(){if(!this.vacancy)return;const n=this.getAttribute("primary-color")||"#2563eb",e=this.getDarkerColor(n),a=r.replace(/\#2563eb/g,n).replace(/\#1d4ed8/g,e),t=document.createElement("div"),o=this.formatSalary(this.vacancy.salary);for(t.innerHTML=`\n            <style>${a}</style>\n            <div class="job-popup-overlay">\n                <div class="job-popup">\n                    <button class="close-popup">×</button>\n                    <h2>${this.vacancy.name}</h2>\n                    ${o?`<div class="salary">${o}</div>`:""}\n                    <div class="company-info">\n                        <span class="company-name">${this.vacancy.employer.name}</span>\n                        ${this.vacancy.employer.trusted?'<span class="verified-badge">✓</span>':""}\n                    </div>\n                    <div class="location">${this.vacancy.area.name}</div>\n                    <div class="description">\n                        ${this.vacancy.description||""}\n                    </div>\n                    <div class="published-date">Вакансия опубликована: ${this.formatDate(this.vacancy.published_at)}</div>\n                    <a href="${this.vacancy.alternate_url}" target="_blank" style="text-decoration: none;">\n                        <button class="apply-button">Откликнуться на вакансию</button>\n                    </a>\n                </div>\n            </div>\n        `;this.shadowRoot.firstChild;)this.shadowRoot.removeChild(this.shadowRoot.firstChild);this.shadowRoot.appendChild(t)}formatSalary(n){if(!n)return"";const{from:e,to:a,currency:t}=n,o=n=>n?n.toLocaleString("ru-RU"):"",i={RUR:"₽",USD:"$",EUR:"€"}[t]||t;return e&&a?`${o(e)} – ${o(a)} ${i}`:e?`от ${o(e)} ${i}`:a?`до ${o(a)} ${i}`:""}formatDate(n){const e=new Date(n),a=new Date-e,t=Math.floor(a/864e5);return 0===t?"Сегодня":1===t?"Вчера":t<7?`${t} ${this.getDaysWord(t)} назад`:e.toLocaleDateString("ru-RU",{day:"numeric",month:"long"})}getDaysWord(n){return n>=5?"дней":n>=2?"дня":"день"}getDarkerColor(n){if(n.startsWith("#")){const e=n.replace("#",""),a=parseInt(e,16),t=a>>16&255,o=a>>8&255,i=255&a;return`#${(Math.max(0,Math.floor(.85*t))<<16|Math.max(0,Math.floor(.85*o))<<8|Math.max(0,Math.floor(.85*i))).toString(16).padStart(6,"0")}`}if(n.startsWith("rgb")){const e=n.match(/\d+/g).map(Number),a=Math.max(0,Math.floor(.85*e[0])),t=Math.max(0,Math.floor(.85*e[1])),o=Math.max(0,Math.floor(.85*e[2]));return 4===e.length?`rgba(${a}, ${t}, ${o}, ${e[3]})`:`rgb(${a}, ${t}, ${o})`}return n}showLoader(){const n=this.getAttribute("primary-color")||"#2563eb",e=r.replace(/\#2563eb/g,n),a=document.createElement("div");for(a.innerHTML=`\n            <style>${e}</style>\n            <div class="job-popup-overlay">\n                <div class="job-popup">\n                    <button class="close-popup">×</button>\n                    <div class="popup-loader"></div>\n                </div>\n            </div>\n        `;this.shadowRoot.firstChild;)this.shadowRoot.removeChild(this.shadowRoot.firstChild);this.shadowRoot.appendChild(a)}}customElements.define("job-popup",s);class l extends HTMLElement{constructor(){super(),this.primaryColor=this.getAttribute("primary-color")||"#2563eb",this.initialized=!1;const n=document.createElement("template");n.innerHTML=a.replace(/\#2563eb/g,this.primaryColor),this.attachShadow({mode:"open"}).appendChild(n.content.cloneNode(!0)),this.shadowRoot.querySelector(".search-form").addEventListener("submit",(n=>{n.preventDefault();const e=this.shadowRoot.querySelector(".search-input").value;this.handleSearch(e)})),this.employerId=this.getAttribute("employer")||"9498112",this.currentPage=0,this.currentQuery="",this.shadowRoot.querySelector(".load-more").addEventListener("click",(()=>{this.loadMoreVacancies()})),this.shadowRoot.addEventListener("click",(n=>{if(n.target.classList.contains("details-button")){const e=n.target.closest(".job-card");if(e){const n=e.dataset.jobId;this.showJobDetails(n)}}(n.target.classList.contains("job-popup-overlay")||n.target.classList.contains("close-popup"))&&this.closePopup()})),this.areas=[],this.initialize(),this.filteredJobs=[],this.initMobileFilters()}static get observedAttributes(){return["primary-color"]}attributeChangedCallback(n,e,a){"primary-color"===n&&e!==a&&(this.primaryColor=a||"#2563eb",this.updateTemplate())}async initialize(){try{this.initialized=!1,this.updateTemplate(),this.initFilters(),await this.loadVacancies()}catch(n){}finally{this.shadowRoot.querySelector(".loader").style.display="none",this.initialized=!0}}updateTemplate(){const n=document.createElement("template"),e=a.replace(/\#2563eb/g,this.primaryColor),t='\n    <style>\n      .close-filters {\n        display: none;\n      }\n      .close-filters:hover {\n        background: #e9ecef;\n        color: #2C3E50;\n      }\n      @media (max-width: 768px) {\n        .close-filters {\n          display: block;\n          background: #f8f9fa;\n          border: none;\n          font-size: 20px;\n          cursor: pointer;\n          padding: 0;\n          width: 36px;\n          height: 36px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          border-radius: 50%;\n          color: #6c757d;\n          transition: all 0.2s ease;\n        }\n      }\n    </style>\n    <div class="filters-container">\n      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">\n        <h3 class="filters-title">Фильтры</h3>\n        <button class="close-filters">×</button>\n      </div>\n      \n      <div class="filter-group">\n        <h4>Опыт работы</h4>\n        <div class="radio-group">\n          <label class="radio-label">\n            <input type="radio" name="experience" value="" checked>\n            <span>Все</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="experience" value="noExperience">\n            <span>Без опыта</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="experience" value="between1And3">\n            <span>1-3 года</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="experience" value="between3And6">\n            <span>3-6 лет</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="experience" value="moreThan6">\n            <span>Более 6 лет</span>\n          </label>\n        </div>\n      </div>\n      \n      <div class="filter-group">\n        <h4>Тип занятости</h4>\n        <div class="radio-group">\n          <label class="radio-label">\n            <input type="radio" name="employment" value="" checked>\n            <span>Все</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="employment" value="full">\n            <span>Полная занятость</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="employment" value="part">\n            <span>Частичная занятость</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="employment" value="project">\n            <span>Проектная работа</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="employment" value="volunteer">\n            <span>Волонтёрство</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="employment" value="probation">\n            <span>Стажировка</span>\n          </label>\n        </div>\n      </div>\n\n      <div class="filter-group">\n        <h4>График работы</h4>\n        <div class="radio-group">\n          <label class="radio-label">\n            <input type="radio" name="schedule" value="" checked>\n            <span>Все</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="schedule" value="fullDay">\n            <span>Полный день</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="schedule" value="shift">\n            <span>Сменный график</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="schedule" value="flexible">\n            <span>Гибкий график</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="schedule" value="remote">\n            <span>Удаленная работа</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="schedule" value="flyInFlyOut">\n            <span>Вахтовый метод</span>\n          </label>\n        </div>\n      </div>\n\n      <div class="filter-group">\n        <h4>Сортировка</h4>\n        <div class="radio-group">\n          <label class="radio-label">\n            <input type="radio" name="order_by" value="publication_time" checked>\n            <span>По дате публикации</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="order_by" value="salary_desc">\n            <span>По убыванию зарплаты</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="order_by" value="salary_asc">\n            <span>По возрастанию зарплаты</span>\n          </label>\n          <label class="radio-label">\n            <input type="radio" name="order_by" value="relevance">\n            <span>По релевантности</span>\n          </label>\n        </div>\n      </div>\n    </div>\n  '.replace(/\#2563eb/g,this.primaryColor);for(n.innerHTML=e.replace("${createFiltersTemplate()}",t);this.shadowRoot.firstChild;)this.shadowRoot.removeChild(this.shadowRoot.firstChild);this.shadowRoot.appendChild(n.content.cloneNode(!0)),this.initialized||(this.shadowRoot.querySelector(".loader").style.display="block"),this.attachEventListeners()}attachEventListeners(){this.shadowRoot.querySelector(".search-form").addEventListener("submit",(n=>{n.preventDefault();const e=this.shadowRoot.querySelector(".search-input").value;this.handleSearch(e)})),this.shadowRoot.querySelector(".load-more").addEventListener("click",(()=>{this.loadMoreVacancies()})),this.shadowRoot.addEventListener("click",(n=>{if(n.target.classList.contains("details-button")){const e=n.target.closest(".job-card");if(e){const n=e.dataset.jobId;this.showJobDetails(n)}}(n.target.classList.contains("job-popup-overlay")||n.target.classList.contains("close-popup"))&&this.closePopup()})),this.shadowRoot.querySelectorAll('input[type="radio"]').forEach((n=>{n.addEventListener("change",(()=>{this.currentPage=0,this.loadVacancies()}))}));const n=this.shadowRoot.querySelector(".mobile-filters-button"),e=this.shadowRoot.querySelector(".filters-container"),a=this.shadowRoot.querySelector(".close-filters");window.innerWidth<=768&&(a.style.display="block"),n.addEventListener("click",(()=>{e.classList.add("active"),document.body.style.overflow="hidden"})),a.addEventListener("click",(()=>{e.classList.remove("active"),document.body.style.overflow=""}));this.shadowRoot.querySelectorAll('.radio-label input[type="radio"]').forEach((n=>{n.addEventListener("change",(()=>{window.innerWidth<=768&&(e.classList.remove("active"),document.body.style.overflow="")}))}))}initFilters(){this.shadowRoot.querySelectorAll('input[type="radio"]').forEach((n=>{n.addEventListener("change",(()=>{this.currentPage=0,this.loadVacancies()}))}))}async loadVacancies(){var n,e,a,t;try{const o=null==(n=this.shadowRoot.querySelector('input[name="experience"]:checked'))?void 0:n.value,r=null==(e=this.shadowRoot.querySelector('input[name="employment"]:checked'))?void 0:e.value,s=null==(a=this.shadowRoot.querySelector('input[name="schedule"]:checked'))?void 0:a.value,l=null==(t=this.shadowRoot.querySelector('input[name="order_by"]:checked'))?void 0:t.value;this.shadowRoot.querySelector(".loader").style.display="block",this.shadowRoot.querySelector(".load-more").style.display="none",this.shadowRoot.querySelector(".jobs-container").innerHTML="";const d={per_page:10,page:this.currentPage,employer_id:this.employerId};o&&(d.experience=o),r&&(d.employment=r),s&&(d.schedule=s),l&&(d.order_by=l),this.currentQuery&&(d.text=this.currentQuery,d.search_field="name");const p=await i(d);this.jobs=this.mapVacanciesToJobs(p.items),this.filteredJobs=this.jobs,this.renderJobs(this.filteredJobs),this.shadowRoot.querySelector(".vacancies-count").textContent=p.found,this.updateLoadMoreButton(p)}catch(o){}finally{this.shadowRoot.querySelector(".loader").style.display="none"}}renderJobs(n){this.shadowRoot.querySelector(".jobs-container").innerHTML=n.map((n=>e(n).replace(/\#2563eb/g,this.primaryColor))).join("")}async handleSearch(n){var e,a,t,o;try{this.currentPage=0,this.currentQuery=n,this.shadowRoot.querySelector(".loader").style.display="block",this.shadowRoot.querySelector(".load-more").style.display="none",this.shadowRoot.querySelector(".jobs-container").innerHTML="";const r=null==(e=this.shadowRoot.querySelector('input[name="experience"]:checked'))?void 0:e.value,s=null==(a=this.shadowRoot.querySelector('input[name="employment"]:checked'))?void 0:a.value,l=null==(t=this.shadowRoot.querySelector('input[name="schedule"]:checked'))?void 0:t.value,d=null==(o=this.shadowRoot.querySelector('input[name="order_by"]:checked'))?void 0:o.value,p={per_page:10,page:this.currentPage,employer_id:this.employerId};r&&(p.experience=r),s&&(p.employment=s),l&&(p.schedule=l),d&&(p.order_by=d),n&&(p.text=n,p.search_field="name");const c=await i(p);this.jobs=this.mapVacanciesToJobs(c.items),this.filteredJobs=this.jobs,this.renderJobs(this.filteredJobs),this.shadowRoot.querySelector(".vacancies-count").textContent=c.found,this.updateLoadMoreButton(c)}catch(r){}finally{this.shadowRoot.querySelector(".loader").style.display="none"}}async loadMoreVacancies(){var n,a,t,o;try{this.currentPage++,this.shadowRoot.querySelector(".loader").style.display="block";const r=null==(n=this.shadowRoot.querySelector('input[name="experience"]:checked'))?void 0:n.value,s=null==(a=this.shadowRoot.querySelector('input[name="employment"]:checked'))?void 0:a.value,l=null==(t=this.shadowRoot.querySelector('input[name="schedule"]:checked'))?void 0:t.value,d=null==(o=this.shadowRoot.querySelector('input[name="order_by"]:checked'))?void 0:o.value,p={per_page:10,page:this.currentPage,employer_id:this.employerId};r&&(p.experience=r),s&&(p.employment=s),l&&(p.schedule=l),d&&(p.order_by=d),this.currentQuery&&(p.text=this.currentQuery,p.search_field="name");const c=await i(p),u=this.mapVacanciesToJobs(c.items);this.jobs=[...this.jobs,...u],this.filteredJobs=this.jobs;this.shadowRoot.querySelector(".jobs-container").innerHTML+=u.map((n=>e(n).replace(/\#2563eb/g,this.primaryColor))).join(""),this.updateLoadMoreButton(c)}catch(r){}finally{this.shadowRoot.querySelector(".loader").style.display="none"}}updateLoadMoreButton(n){const e=this.shadowRoot.querySelector(".load-more"),a=10*(this.currentPage+1)<n.found;e.style.display=a?"block":"none"}async showJobDetails(n){try{this.shadowRoot.querySelectorAll("job-popup").forEach((n=>n.remove()));const e=document.createElement("job-popup");e.setAttribute("primary-color",this.primaryColor),this.shadowRoot.appendChild(e),e.showLoader();const a=await async function(n){try{const e=await fetch(`${t}/vacancies/${n}`,{headers:o});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){throw e}}(n);e.setContent(a)}catch(e){}}mapVacanciesToJobs(n){return n.map((n=>{var e;return{id:n.id,viewers:(null==(e=n.counters)?void 0:e.responses)||0,title:n.name,salary:n.salary,company:n.employer.name,verified:n.employer.trusted,location:n.area.name,published_at:n.published_at,tags:[{text:"Нет опыта"==n.experience.name?"Без опыта":n.experience.name},n.schedule&&{text:n.schedule.name},n.employment&&{text:n.employment.name}].filter(Boolean)}}))}initMobileFilters(){window.addEventListener("resize",(()=>{const n=this.shadowRoot.querySelector(".filters-container");window.innerWidth<=768&&n.classList.remove("active")}))}}var d;return(d="undefined"!=typeof window?window:void 0).customElements&&!d.customElements.get("my-vacancies")&&d.customElements.define("my-vacancies",l),d.MyVacancies=l,"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd&&define([],(function(){return l})),l}));
